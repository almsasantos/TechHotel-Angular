!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.name=t():(e["angular-osm"]=e["angular-osm"]||{},e["angular-osm"].name=t())}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var u=n[r]={exports:{},id:r,loaded:!1};return e[r].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(4)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),o=r(u),i=n(3),a=r(i),s=angular.module("osm.api",[a.default.name]).provider("osmAPI",function(){this.options={url:"http://api.openstreetmap.org/api"},this.$get=function(e,t,n){return new o.default(e,t,n,this.options)},this.$get.$inject=["$http","$q","osmx2js"]});t.default=s},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(t,r,u,o){n(this,e),this.url=o.url,this.$http=t,this.$q=r,this.osmx2js=u,this._oauth=null}return r(e,[{key:"setAuthAdapter",value:function(e){this._oauth=e}},{key:"getAuthAdapter",value:function(){return this._oauth}},{key:"xhr",value:function(e){this.$q.defer();return this._oauth.xhr(e)}},{key:"getAuthenticated",value:function(e,t){var n=angular.copy(t);return n||(n={}),n.method="GET",n.path=e,this.xhr(n)}},{key:"get",value:function(e,t){var n=this.$q.defer(),r=this,u=this.url+e;return this.$http.get(u,t).then(function(e){n.resolve(r.osmx2js.xml2js(e.data))},function(e){n.reject(e)}),n.promise}},{key:"put",value:function(e,t,n){n||(n={});var r=angular.copy(n);return r.method="PUT",r.path=e,r.data=this.osmx2js.js2xml(t),r.options={},r.options.header={"Content-Type":"text/xml"},this.xhr(r)}},{key:"delete",value:function(e,t){t||(t={});var n=angular.copy(t);return n.method="DELETE",n.path=e,this.xhr(n)}},{key:"createChangeset",value:function(e,t){var n=this.$q.defer(),r={osm:{changeset:{tag:[{_k:"created_by",_v:t||"Angular-OSM"},{_k:"comment",_v:e}]}}};return this.put("/0.6/changeset/create",r).then(function(e){n.resolve(e)}),n.promise}},{key:"getLastOpenedChangesetId",value:function(){var e=this.$q.defer(),t={params:{user:this._oauth.getUserID(),open:!0}};return this.get("/0.6/changesets",t).then(function(t){var n=t.osm.changeset;n.length>0?e.resolve(n[0].id):n._id?e.resolve(n._id):e.resolve()}),e.promise}},{key:"closeChangeset",value:function(e){return this.put("/0.6/changeset/"+e+"/close").then(function(e){return e})}},{key:"getUserById",value:function(e){return this.getAuthenticated("/0.6/user/"+e)}},{key:"getUserDetails",value:function(){return this.getAuthenticated("/0.6/user/details")}},{key:"getUserPreferences",value:function(){return this.getAuthenticated("/0.6/user/preferences")}},{key:"putUserPreferences",value:function(e,t){return this.put("/0.6/user/preferences/"+e,t)}},{key:"getMap",value:function(e){return this.get("/0.6/map?bbox="+e)}},{key:"getNotes",value:function(e){var t="/0.6/notes?bbox="+e;return this.get(t)}},{key:"createNode",value:function(e){return this.put("/0.6/node/create",e)}},{key:"getNode",value:function(e){return this.get("/0.6/node/"+e)}},{key:"getNodeRelations",value:function(e){return this.get("/0.6/node/"+e+"/relations")}},{key:"getNodeWays",value:function(e){return this.get("/0.6/node/"+e+"/ways")}},{key:"getNodes",value:function(e){return this.get("/0.6/nodes?nodes="+e.join(","))}},{key:"deleteNode",value:function(e){return this.delete("/0.6/node/"+e)}},{key:"createWay",value:function(e){return this.put("/0.6/way/create",e)}},{key:"getWay",value:function(e){return this.get("/0.6/way/"+e)}},{key:"getWayRelations",value:function(e){return this.get("/0.6/way/"+e+"/relations")}},{key:"getWayFull",value:function(e){return this.get("/0.6/way/"+e+"/full")}},{key:"getWays",value:function(e){return this.get("/0.6/ways?ways="+e.join(","))}},{key:"deleteWay",value:function(e){return this.delete("/0.6/way/"+e)}},{key:"createRelation",value:function(e){return this.put("/0.6/relation/create",e)}},{key:"getRelation",value:function(e){return this.get("/0.6/relation/"+e)}},{key:"getRelationRelations",value:function(e){return this.get("/0.6/relation/"+e+"/relations")}},{key:"getRelationFull",value:function(e){return this.get("/0.6/relation/"+e+"/full")}},{key:"getRelations",value:function(e){return this.get("/0.6/relations?relations="+e.join(","))}},{key:"deleteRelation",value:function(e){return this.delete("/0.6/relation/"+e)}}]),e}();u.$inject=["$http","$q","osmx2js"],t.default=u},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=angular.module("osm.x2js",[]).provider("osmx2js",function(){this.options={},this.$get=function(){return new X2JS(this.options)}});t.default=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=n(5),o=r(u),i=n(1),a=r(i),s=n(3),l=r(s),c=angular.module("osm.base64",[l.default.name,a.default.name,"base64"]).provider("osmBase64",function(){this.options={url:"http://api.openstreetmap.org/api"},this.$get=function(e,t,n,r){return new o.default(e,t,n,r,this.options)},this.$get.$inject=["$base64","$http","osmx2js"]});t.default=c},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(t,r,u){n(this,e),this.$base64=t,this.storage={},this.$http=r,this.url="http://api.openstreetmap.org/api",this.osmx2js=u}return r(e,[{key:"xhr",value:function(e){var t=this;return e.url=this.url+e.path,e.headers={Authorization:this.getAuthorization()},this.$http(e).then(function(e){var n=e.data;if(n)return n.substr&&"<?xml"===n.substr(0,5)?t.osmx2js.xml2js(n):n})}},{key:"setCredentials",value:function(e,t){this.storage.username=e;var n=this.$base64.encode(e+":"+t);return this.storage.credentials=n,n}},{key:"getCredentials",value:function(){return this.storage.credentials}},{key:"getAuthorization",value:function(){return"Basic "+this.storage.credentials}},{key:"clearCredentials",value:function(){this.storage.removeItem?this.storage.removeItem("credentials"):delete this.storage.credentials}}]),e}();u.$inject=["$base64","$http","osmx2js"],t.default=u}])});